app-id: io.github.benjamimgois.serialcom
runtime: org.kde.Platform
runtime-version: '6.10'
sdk: org.kde.Sdk
base: com.riverbankcomputing.PyQt.BaseApp
base-version: '6.10'
command: serialcom

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=all
  - --talk-name=org.freedesktop.Flatpak

cleanup-commands:
  - /app/cleanup-BaseApp.sh

modules:
  - name: picocom
    buildsystem: simple
    build-commands:
      - make
      - install -Dm755 picocom ${FLATPAK_DEST}/bin/picocom
    sources:
      - type: archive
        url: https://github.com/npat-efault/picocom/archive/refs/tags/3.1.tar.gz
        sha256: e6761ca932ffc6d09bd6b11ff018bdaf70b287ce518b3282d29e0270e88420bb
        x-checker-data:
          type: anitya
          project-id: 11061
          url-template: https://github.com/npat-efault/picocom/archive/refs/tags/$version.tar.gz

  - name: serialcom
    buildsystem: simple
    build-commands:
      - install -Dm755 serialcom ${FLATPAK_DEST}/bin/serialcom
      - install -Dm644 serialcom.png ${FLATPAK_DEST}/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png
      - install -Dm644 icons/serialcom-256.png ${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png
      - install -Dm644 icons/serialcom-128.png ${FLATPAK_DEST}/share/icons/hicolor/128x128/apps/${FLATPAK_ID}.png
      - install -Dm644 icons/serialcom-64.png ${FLATPAK_DEST}/share/icons/hicolor/64x64/apps/${FLATPAK_ID}.png
      - install -Dm644 icons/serialcom-48.png ${FLATPAK_DEST}/share/icons/hicolor/48x48/apps/${FLATPAK_ID}.png
      - install -Dm644 icons/serialcom-32.png ${FLATPAK_DEST}/share/icons/hicolor/32x32/apps/${FLATPAK_ID}.png
      - install -Dm644 arrow_down.svg ${FLATPAK_DEST}/share/${FLATPAK_ID}/arrow_down.svg
      - install -Dm644 ${FLATPAK_ID}.desktop ${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.desktop
      - install -Dm644 ${FLATPAK_ID}.metainfo.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml
      - install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/${FLATPAK_ID}/LICENSE
    sources:
      - type: archive
        url: https://github.com/benjamimgois/serialcom/archive/refs/tags/1.1.tar.gz
        sha256: a4ed7faa5ff8f5b7a68c1d9e679d62c455087f3d55245a339069c80d42015403
        x-checker-data:
          type: anitya
          project-id: 381498
          url-template: https://github.com/benjamimgois/serialcom/archive/refs/tags/$version.tar.gz
